var Client;(()=>{"use strict";var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};async function a(e){const t=document.getElementById("city").value,a=document.getElementById("dateOfTrip").value,s=document.getElementById("endDate").value;if(!a&&!s)return void alert("Please select the date of trip!");const l=(new Date).toLocaleDateString(),d=new Date,m=new Date(a),h=new Date(s),g=Math.ceil((m-d)/864e5),y=h.getTime()-m.getTime(),p=Math.ceil(y/864e5);try{const[e,s]=await Promise.all([n(t),r(t)]);if(e){const{lat:t,lng:n,countryName:r}=e,d=await o(t,n);if(d){const e=d.data.find((e=>e.datetime===a));if(e){const o={latitude:t,longitude:n,country:r,countdown:g,date:l,TripLength:p,tripDate:a,weather:{description:e.weather.description,temp:e.temp,high_temp:e.high_temp,low_temp:e.low_temp},images:s};await i("/add",o),await c()}else alert("There is no weather information available for the chosen travel date.")}else alert("Failed to fetch weather data!")}else alert("No data found. Please try another city.")}catch(e){console.error("Error",e)}}e.r(t),e.d(t,{performAction:()=>a});const n=async e=>{const t=`q=${e}&maxRows=1&username=danaak`,a=await fetch("http://api.geonames.org/searchJSON?"+t);try{if(!a.ok)throw new Error("Network response was not ok");const e=await a.json();return e.geonames&&e.geonames.length>0?e.geonames[0]:(console.error("No data found for the city."),null)}catch(e){console.log("Error",e)}},o=async(e,t)=>{const a=`?lat=${e}&lon=${t}&key=58b51563876c48e8ba2c77c7c11600dc`;try{const e=await fetch("https://api.weatherbit.io/v2.0/forecast/daily"+a);if(!e.ok)throw new Error("Failed to fetch weather data");return await e.json()}catch(e){console.error("Error",e)}},r=async e=>{const t=`?key=48600013-d49c966ea3d58746d45cde058&q=${encodeURIComponent(e)}&image_type=photo&per_page=3`;try{const e=await fetch("https://pixabay.com/api/"+t);if(!e.ok)throw new Error("Failed to fetch images data");return(await e.json()).hits.map((e=>e.largeImageURL))}catch(e){console.error("Error",e)}},i=async(e="",t={})=>{const a=await fetch(e,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});try{const e=await a.json();return console.log("Posted successfully:",e),e}catch(e){console.log("Error occurred while posting data:",e)}},c=async()=>{try{await(async()=>{const e=await fetch("/all");try{const t=await e.json();if(document.getElementById("country").innerHTML=t.country?`Country: ${t.country}`:"No country data",document.getElementById("date").innerHTML=`Submission date: ${t.date}`||"No date available",document.getElementById("countdown").innerHTML=void 0!==t.countdown?`Days until trip: ${t.countdown}`:"No trip date set",t.weather?document.getElementById("weather").innerHTML=`\n                Weather on Trip Date: ${t.weather.description}\n                Temp: ${t.weather.temp}°C \n                High: ${t.weather.high_temp}°C \n                Low: ${t.weather.low_temp}°C\n            `:document.getElementById("weather").innerHTML="No weather data available",t.images&&t.images.length>0){const e=document.getElementById("images");e.innerHTML='<h3 style="margin: 10px 0">Images:</h3>',e.innerHTML+=t.images.map((e=>`<img src="${e}" alt="Travel Image" style="  width: 30%; height:200px; margin: 5px;">`)).join("")}else document.getElementById("images").innerHTML="No images available";document.getElementById("TripLength").innerHTML=t.TripLength?`Trip length: ${t.TripLength} days`:"No trip length data available"}catch(e){console.log("Error",e)}})()}catch(e){console.error("Error updating UI:",e)}};document.getElementById("generate").addEventListener("click",a),"serviceWorker"in navigator&&window.addEventListener("load",(()=>{navigator.serviceWorker.register("/service-worker.js")})),Client=t})();